---
title: "MaStat CompStat HW"
author: "Sander Bossier"
date: "`r Sys.Date()`"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

## 1.

```{r}
HairEye <- apply(
  X = HairEyeColor,
  MARGIN = c(1, 2),
  FUN = sum
)
ClassSurvived <- apply(
  X = Titanic,
  MARGIN = c(1,4),
  FUN = sum
)
```

## 2.

```{r}
HairEye[
  order(rowSums(HairEye), decreasing = TRUE),
  order(colSums(HairEye), decreasing = TRUE)
]
```

## 3.

```{r}
# Convert the matrix to a vector and rank the elements
ranked_vector <- rank(as.vector(HairEye), ties.method = "first")

# Convert the ranked vector back to a matrix with the same dimensions as HairEye
ranked_HairEye <- matrix(ranked_vector, nrow = nrow(HairEye), ncol = ncol(HairEye))

# Assign the dimnames from the original HairEye matrix to the ranked matrix
dimnames(ranked_HairEye) <- dimnames(HairEye)
ranked_HairEye
```

## 4.

```{r}
c(HairEye["Brown", "Brown"],
  HairEye["Blond", "Blue"],
  HairEye["Brown", "Blue"])
HairEye["Brown","Brown"]

```

## 5.

```{r}
table <- as.table(HairEye)
df <- as.data.frame(table)
knitr::kable(df)
```

## 6.

```{r}
all2x2 <- lapply(seq_len(nrow(HairEye)), function(i) {
  lapply(seq_len(ncol(HairEye)), function(j) {
    cell_value <- HairEye[i, j]
    row_sum <- sum(HairEye[i, -j])
    col_sum <- sum(HairEye[-i, j])
    other_sum <- sum(HairEye[-i, -j])
    matrix(c(cell_value, col_sum, row_sum, other_sum), nrow = 2)
  })
})

# Flatten the list of lists to a single list
all2x2 <- do.call(c, all2x2)
all2x2
```

## 7.

```{r}
all2x2for <- expression({all2x2 <- vector("list", length = nrow(HairEye) * ncol(HairEye))
index <- 1

for (i in 1:nrow(HairEye)) {
  for (j in 1:ncol(HairEye)) {
    # The value of the cell itself
    cell_value <- HairEye[i, j]
    
    # Sum of values in the same row but not in the same column
    row_sum <- sum(HairEye[i, -j])
    
    # Sum of values in the same column but not in the same row
    col_sum <- sum(HairEye[-i, j])
    
    # Sum of the values not in the same row or column
    other_sum <- sum(HairEye[-i, -j])
    
    # Create the 2x2 matrix
    matrix_2x2 <- matrix(
      c(cell_value, col_sum, row_sum, other_sum), nrow = 2
      )
    
    # Add the 2x2 matrix to the list
    all2x2[[index]] <- matrix_2x2
    index <- index + 1
  }
}

all2x2})
```

```{r}
library(microbenchmark)
resultfor <- microbenchmark(all2x2for,
               unit = "us")
result <- summary(resultfor)
```

The average time of computation is `r result$mean` microseconds and the average time of the second computation is `r ` microseconds.

```{r}
result$mean
```

